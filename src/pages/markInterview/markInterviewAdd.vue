<template>
    <div id="narkInterviewAdd">
      <!-- 卡片 -->
      <el-card class="box-card">
        <div class="text item">
          <h2>毕业生就业市场开拓走访信息反馈表</h2>
          <el-form ref="form" :model="form" label-width="80px">
            <el-form-item label="走访人员">
              <el-input v-model="form.visitor_name"></el-input>
            </el-form-item>
            <el-form-item label="时间">
              <el-col :span="11">
                <el-date-picker type="date" placeholder="选择日期" v-model="form.time" style="width: 100%;"></el-date-picker>
             </el-col>
            </el-form-item>
            <el-form-item label="单位名称">
              <el-input v-model="form.company_name"></el-input>
            </el-form-item>
            <el-form-item label="单位性质">
              <el-input v-model="form.company_nature"></el-input>
            </el-form-item>
            <el-form-item label="通讯地址">
              <el-input v-model="form.company_place"></el-input>
            </el-form-item>
            <el-form-item label="邮编">
              <el-input v-model="form.postcode"></el-input>
            </el-form-item>
            <el-form-item label="走访情况">
              <br>
              <!-- 增加 -->
              <el-button type="primary" @click="addRow(vP)">新增</el-button>
              <!-- 走访情况表格 -->
                <el-table :data="vP" v-model="vP" style="width: 100%">
                <el-table-column prop="contact" label="联系人" width="180">
                    <template slot-scope="scope">
                      <!-- <el-form :model="scope.row" :rules="rules">
                        <el-form-item prop="contact"> -->
                          <el-input v-model="scope.row.contact" placeholder="姓名"></el-input>
                        <!-- </el-form-item>
                      </el-form> -->
                    </template>
                </el-table-column>
                <el-table-column prop="position" label="职务" width="180">
                  <template slot-scope="scope">
                      <!-- <el-form :model="scope.row" :rules="rules">
                        <el-form-item prop="position"> -->
                          <el-input v-model="scope.row.position" placeholder="职务"></el-input>
                        <!-- </el-form-item>
                      </el-form> -->
                    </template>
                </el-table-column>
                <el-table-column prop="phoneNum" label="手机">
                  <template slot-scope="scope">
                      <!-- <el-form :model="scope.row" :rules="rules">
                        <el-form-item prop="phoneNum"> -->
                          <el-input v-model="scope.row.mobiephone" placeholder="手机号码"></el-input>
                        <!-- </el-form-item>
                      </el-form> -->
                    </template>
                </el-table-column>
                <el-table-column prop="fixedPhone" label="固话">
                  <template slot-scope="scope">
                      <!-- <el-form :model="scope.row" :rules="rules">
                        <el-form-item prop="fixedPhone"> -->
                          <el-input v-model="scope.row.fixedphone" placeholder="固话"></el-input>
                        <!-- </el-form-item>
                      </el-form> -->
                    </template>
                </el-table-column>
                <el-table-column prop="email" label="EMAIL">
                  <template slot-scope="scope">
                      <!-- <el-form :model="scope.row" :rules="rules">
                        <el-form-item prop="email"> -->
                          <el-input v-model="scope.row.email" placeholder="邮箱"></el-input>
                        <!-- </el-form-item>
                      </el-form> -->
                    </template>
                </el-table-column>
                <el-table-column prop="wechat" label="微信/QQ">
                  <template slot-scope="scope">
                      <!-- <el-form :model="scope.row" :rules="rules">
                        <el-form-item prop="wechat"> -->
                          <el-input v-model="scope.row.webchatqq" placeholder="微信/QQ"></el-input>
                        <!-- </el-form-item>
                      </el-form> -->
                    </template>
                </el-table-column>
                <el-table-column label="操作">
                    <template slot-scope="scope">
                      <!-- <el-form :model="scope.row">
                        <el-form-item> -->
                          <el-button @click.native.prevent="deleteRow(scope.$index, vP)" size="small">删除</el-button>
                        <!-- </el-form-item>
                      </el-form> -->
                    </template>
                </el-table-column>
              </el-table>
            </el-form-item>

            <el-form-item label="岗位需求">
              <el-button type="primary" @click="addRow(pR)">新增</el-button>
              <!-- 岗位需求表格 -->
              <el-table :data="pR" v-model="pR" style="width:100%">
                <el-table-column prop="major" label="学科">
                  <template slot-scope="scope">
                    <el-input v-model="scope.row.subject" placeholder="学科"></el-input>
                  </template>
                </el-table-column>
                <el-table-column prop="eduBackground" label="学历">
                  <template slot-scope="scope">
                    <el-input v-model="scope.row.education" placeholder="学历"></el-input>
                  </template>
                </el-table-column>
                <el-table-column prop="amount" label="数量">
                  <template slot-scope="scope">
                    <el-input v-model="scope.row.number" placeholder="数量"></el-input>
                  </template>
                </el-table-column>
                <el-table-column prop="other" label="其他">
                  <template slot-scope="scope">
                    <el-input v-model="scope.row.others" placeholder="其他"></el-input>
                  </template>
                </el-table-column>
                <el-table-column label="操作">
                    <template slot-scope="scope">
                          <el-button @click.native.prevent="deleteRow(scope.$index, pR)" size="small">删除</el-button>
                    </template>
                </el-table-column>
              </el-table>
            </el-form-item>

            <el-form-item label="参会意向">
              <el-checkbox-group v-model="form.PI">
              <el-checkbox label="1" name="type">秋季非师范毕业生专场</el-checkbox>
              <el-checkbox label="2" name="type">秋季精品洽谈月专场</el-checkbox>
              <el-checkbox label="3" name="type">全国高校毕业生教育人才招聘会</el-checkbox>
              <el-checkbox label="4" name="type">春季非师范毕业生专场</el-checkbox>
              <el-checkbox label="5" name="type">春季精品洽谈月专场</el-checkbox>
              <el-checkbox label="6" name="type">网上发布招聘信息</el-checkbox>
              <el-checkbox label="7" name="type">暂不考虑参加招聘会</el-checkbox>
              </el-checkbox-group>
            </el-form-item>
            <el-form-item label="校友资源">
              <!-- 校友资源表格 -->
              <el-button type="primary" @click="addRow(sF)">新增</el-button>
              <el-table :data="sF" v-model="sF" style="width:100%">
                <el-table-column label="姓名" prop="name">
                  <template slot-scope="scope">
                    <el-input v-model="scope.row.name" placeholder="姓名"></el-input>
                  </template>
                </el-table-column>
                <el-table-column prop="alu_major" label="专业">
                  <template slot-scope="scope">
                    <el-input v-model="scope.row.major" placeholder="专业"></el-input>
                  </template>
                </el-table-column>
                <el-table-column prop="alu_eduBackground" label="学历">
                  <template slot-scope="scope">
                    <el-input v-model="scope.row.education" placeholder="学历 "></el-input>
                  </template>
                </el-table-column>
                <el-table-column prop="entryTime" label="入职时间">
                  <template slot-scope="scope">
                    <el-input v-model="scope.row.time" placeholder="入职时间"></el-input>
                  </template>
                </el-table-column>
                <el-table-column prop="contactWay" label="联系方式">
                  <template slot-scope="scope">
                    <el-input v-model="scope.row.contact" placeholder="联系方式"></el-input>
                  </template>
                </el-table-column>
                <el-table-column label="操作">
                    <template slot-scope="scope">
                          <el-button @click.native.prevent="deleteRow(scope.$index, sF)" size="small">删除</el-button>
                    </template>
                </el-table-column>
              </el-table>
            </el-form-item>
            <el-form-item label="单位信息反馈">
             <el-input type="textarea" v-model="form.feedback"></el-input>
            </el-form-item>
            <el-form-item label="简要总结">
             <el-input type="textarea" v-model="form.conclude"></el-input>
            </el-form-item>
            <el-form-item>
              <el-button type="primary" @click="onSubmit" plain>确定</el-button>
              <el-button type="info" plain>取消</el-button>
            </el-form-item>
          </el-form>
        </div>
      </el-card>
    </div>
</template>

<script>
import axios from 'axios';
import qs from 'qs';
export default {
    data() {
      return {
        form: {
          visitor_name: '',
          time: '',
          company_name:'',
          company_nature:'',
          company_place:'',
          postcode:'',
          PI: [],
          feedback: '',
          conclude:'',
          vP:[],
          pR:[],
          sF:[]
        },
        // 走访表格
        vP:[],
        // 岗位需求表格
        pR:[],
        // 校友资源表格
        sF:[],
      }
    },
    mounted(){
      this.form.vP=this.vP
      this.form.pR=this.pR
      this.form.sF=this.sF
    },
    methods: {
      deleteRow(index, rows) {//删除改行
        rows.splice(index, 1);
      },
     addRow(tableData,event){
       console.log(typeof(tableData))
       if (tableData==this.vP) {
         tableData.push({ contact: '',position:'',mobiephone:'',fixedphone:'',email:'',webchatqq:''
          })
          return tableData
       }else if (tableData==this.pR) {
         tableData.push({
           subject:'',education:'',number:'',others:''
         })
         return tableData
       } else if (tableData==this.sF){
         tableData.push({
           name:'',major:'',education:'',time:'',contact:''
         })
         return tableData
       }else{
         return false
       }
       
     },
      onSubmit(){
        console.log(this.form)
        let data=qs.stringify(this.form)
        // let data=this.form
        axios({
          method:'post',
          url:this.backendUrl+'/interview/addInterview',
          data:data,
          headers: {'Content-Type': 'application/x-www-form-urlencoded'},
        }).then(response=>{
          console.log(response)
        }).catch(error=>{
          console.log(error)
        })
      }

    }//methods结束
  }
</script>

<style scoped>
/* 全局 */
body{
  margin: 0;
  padding: 0;
}
#app {
  font-family: 'Avenir', Helvetica, Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-align: center;
  color: #2c3e50;
  /* margin-top: 60px; */
}
.el-aside {
  /* background-color: #D3DCE6; */
  color: #333;
  text-align: center;
  line-height: 200px;
}
.el-header {
  /* background-color: #B3C0D1; */
  color: #333;
  /* line-height: 60px; */
}
  
.el-main {
  /* background-color: #E9EEF3; */
  color: #333;
  text-align: center;
  /* line-height: 160px; */
}
/* 卡片 */
/* .text {
    font-size: 14px;
} */

.item {
    padding: 18px 0;
}

.box-card {
    width: 100%;
    margin: 30px 0;
    text-align: left;
}
</style>